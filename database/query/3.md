# WindowFunction
## SparkSQL中Window语法
参考链接：[SparkSQL中Window语法](https://spark.apache.org/docs/latest/sql-ref-syntax-qry-select-window.html)

<img width="918" alt="image" src="https://github.com/user-attachments/assets/97d0f49b-0958-433e-b6bc-dbba92d89646">
<img width="971" alt="image" src="https://github.com/user-attachments/assets/66c1a242-9fcd-418d-9312-e799a9155d2b">

## window_frame中RANGE VS ROWS对比
```
id	period	shop	revenue
1	2021/04	Shop 2	341,227.53
2	2021/05	Shop 2	315,447.24
3	2021/06	Shop 1	1,845,662.35
4	2021/04	Shop 2	21,487.63
5	2021/05	Shop 1	1,489,774.16
6	2021/06	Shop 1	52,489.35
7	2021/04	Shop 1	154,552.82
8	2021/05	Shop 2	6,548.49
9	2021/06	Shop 2	387,779.49
```

### ROWS参数结果
```
SELECT
  period,
  shop,
  revenue,
  SUM(revenue) OVER(
    PARTITION BY shop
    ORDER BY period ASC
    ROWS UNBOUNDED PRECEDING
  ) AS rows_cumulative_revenue
FROM revenue_consolidation;
```
![image](https://github.com/user-attachments/assets/719454b1-a06f-42b4-8e8b-1efc686c4151)

### RANGE参数结果
```
SELECT
  period,
  shop,
  revenue,
  SUM(revenue) OVER(
    PARTITION BY shop
    ORDER BY period ASC
    RANGE UNBOUNDED PRECEDING
  ) AS range_cumulative_revenue
FROM revenue_consolidation;
```
![image](https://github.com/user-attachments/assets/d4960740-ec81-4e19-83bd-35db8b666538)


